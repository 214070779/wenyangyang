---
title: è´§æ‹‰æ‹‰åŒ…ä½“ç§¯ä¼˜åŒ–
date: 2024-09-30 09:54:05
permalink: /pages/11d363/
---

# è´§æ‹‰æ‹‰iOSåŒ…ä½“ç§¯ä¼˜åŒ–æ€»ç»“



#### ä¸€ã€å‰è¨€

æ›´å°çš„åŒ…ä½“ç§¯æœ‰åŠ©äºæ‹‰æ–°æ¨å¹¿ï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œåœ¨æ¨å¹¿APPæ—¶ç‰¹åˆ«æ˜¯åœ¨æˆ·å¤–ï¼Œæ˜¯ä¸æ˜¯åŒ…ä½“ç§¯å°çš„æ›´å®¹æ˜“è®©ç”¨æˆ·ä¸‹è½½å‘¢ï¼Ÿæ›´å°çš„åŒ…ä½“ç§¯å ç”¨æ›´å°ç£ç›˜ç©ºé—´ï¼Œä¸‹è½½æ›´å¿«ï¼Œæ¶ˆè€—æ•°æ®æµé‡ä¹Ÿæ›´å°‘ï¼›æ­¤å¤–ï¼ŒåŒ…ä½“ç§¯æ˜¯ä¸€ä¸ªç»¼åˆçš„æ€§èƒ½æŒ‡æ ‡ï¼Œæ›´å°çš„åŒ…ä½“ç§¯é€šå¸¸ä¹Ÿæ„å‘³ç€æ›´å¿«çš„APPå¯åŠ¨é€Ÿåº¦ï¼Œèƒ½æå‡ç”¨æˆ·ä½“éªŒã€‚

æˆ‘ä»¬å¹³å°å°±åŒ…ä½“ç§¯é—®é¢˜å·²ç»åšè¿‡å¤šæ¬¡ä¼˜åŒ–ï¼Œç´¯è®¡ä¼˜åŒ–è¾¾åˆ°42MB+ï¼Œæˆªæ­¢åˆ°`2.0.22`ç‰ˆæœ¬ï¼ŒåŒ…ä½“ç§¯æ˜¯92.1MBï¼Œåœ¨è¡Œä¸šåŒç±»APPä¸­å¤„äºé¢†å…ˆã€‚åŒ…ä½“ç§¯ä¼˜åŒ–è¯é¢˜è€ç”Ÿå¸¸è°ˆï¼Œä½†éšç€è‹¹æœç³»ç»Ÿçš„ä¸æ–­è¿­ä»£ï¼Œä¼˜åŒ–æ–¹å¼ä¹Ÿåœ¨å˜åŒ–ï¼Œæœ¬æ–‡æ˜¯åŸºäºå½“å‰çš„ä¸€äº›å®è·µæ€»ç»“ï¼Œä¸‹é¢å°±ä»ç»Ÿè®¡å£å¾„ã€æ²»ç†æ€è·¯ã€å…·ä½“çš„å®è·µæ¥è®²è¿°åŒ…ä½“ç§¯å·¥ä½œå¦‚ä½•å¼€å±•ã€‚

![image01.png](https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e71e9487679b470f853d4e5f04000f80~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&x-expires=1727931961&x-signature=2rfAvTR%2BH9BSJGG4%2FFVjit%2FdZvE%3D)

#### äºŒã€ç»Ÿè®¡å£å¾„

##### 2.1 ç»Ÿè®¡å£å¾„

iOSå·¥ç¨‹ä»æ‰“åŒ…åˆ°ç”Ÿæˆ`ipa`Â -ã€‹ä¸‹è½½åŒ… -ã€‹å®‰è£…åŒ…çš„æµç¨‹å¦‚ä¸‹ï¼š

![image02.png](https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3481ce725b04c94bdfedd01ac06a1f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&x-expires=1727931961&x-signature=ppmJnlQUwwnS0bR00JiTIa6xst4%3D)

- **IPAåŒ…å¤§å°ï¼š**Â iOSå·¥ç¨‹æ‰“åŒ…ååŸå§‹appå‹ç¼©åçš„å¤§å°ã€‚ä¸Šä¼ `App Store Connect`åä¼šè¿›è¡Œ`APP Thinning`å¤„ç†ï¼Œç”Ÿæˆè®¾å¤‡æ‰€éœ€çš„ç‰¹å®šæ¶æ„å’Œèµ„æºçš„**å˜ä½“ç‰ˆæœ¬**ã€‚
- **ä¸‹è½½å¤§å°ï¼š**Â æ˜¯å˜ä½“ç‰ˆæœ¬ç»è¿‡å‹ç¼©çš„ç‰ˆæœ¬ï¼Œæ˜¯å®é™…ä¸‹è½½çš„å¤§å°ã€‚
- **å®‰è£…å¤§å°ï¼š**Â å®‰è£…åå ç”¨çš„ç£ç›˜å¤§å°ï¼Œä¹Ÿæ˜¯åœ¨`App Store`ä¸­ç”¨æˆ·çœ‹åˆ°çš„å¤§å°ã€‚

ç»¼ä¸Šï¼Œæˆ‘ä»¬é€‰æ‹©äº†å®‰è£…å¤§å°ä½œä¸ºä¼˜åŒ–ç»Ÿè®¡çš„å£å¾„ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨`App Store Connect`çš„`TestFlight -> æ„å»ºç‰ˆæœ¬-> æ„å»ºç‰ˆæœ¬å…ƒæ•°æ® -> APPæ–‡ä»¶å¤§å°`ä¸­æŸ¥çœ‹ç»è¿‡`APP Thinning`åçš„å„ä¸ª`å˜ä½“ç‰ˆæœ¬`å¤§å° ã€‚

![](https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79f0451cd08642748663ee16588028d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&x-expires=1727931961&x-signature=%2FZoz3oTAVXXrnb%2FqwX6dnmmINAg%3D)

##### 2.2 è‹¹æœå…³äºåŒ…ä½“ç§¯çš„ç›¸å…³é™åˆ¶

**1. APPæ–‡ä»¶å¤§å°çš„é™åˆ¶**

> - æ‚¨çš„åº”ç”¨ç¨‹åºçš„æœªå‹ç¼©æ€»å¤§å°å¿…é¡»å°äº4GBï¼ŒApple Watchåº”ç”¨ç¨‹åºå¿…é¡»å°äº75MBã€‚
> - iOS 9.0ä¹‹åï¼Œæ¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰€æœ‰`__TEXT`æ®µçš„å¤§å°ä¸è¶…è¿‡500MBã€‚

**2.App Store OTA ä¸‹è½½å¤§å°é™åˆ¶**

Appstoreå¯¹ä½¿ç”¨èœ‚çªç½‘ç»œä¸‹è½½æœ‰é™åˆ¶ï¼Œè‹¥ä¸‹è½½å¤§å°è¶…è¿‡é™åˆ¶ï¼Œ`iOS 13`Â ä¹‹å‰æ— æ³•ä½¿ç”¨èœ‚çªç½‘ç»œä¸‹è½½ Appï¼Œéœ€é€šè¿‡ Wi-Fi ç½‘ç»œä¸‹è½½ï¼›`iOS 13`Â ä¹‹åé»˜è®¤ä¼šå¼¹æ¡†è®©ç”¨æˆ·é€‰æ‹©æ˜¯å¦ä¸‹è½½ã€‚å¦‚ä¸‹ä¸ºè‹¹æœå†å¹´æ¥å¯¹ App èœ‚çªç½‘ç»œä¸‹è½½é™åˆ¶çš„å˜åŒ–ï¼š

> - iOS 11 æ­£å¼ç‰ˆåï¼ŒOTAä¸‹è½½å¤§å°é™åˆ¶ä» 100 MB æå‡è‡³ 150 MBã€‚
> - iOS 12.4åŠåç»­ç‰ˆæœ¬ï¼Œè‹¹æœæŠŠ OTA ä¸‹è½½å¤§å°é™åˆ¶æ”¾å®½åˆ° 200MBã€‚
> - iOS13 åŠä»¥ä¸Šç”¨æˆ·å¯ä»¥ä½¿ç”¨æµé‡ä¸‹è½½è¶…å‡º 200MBï¼ˆä¸‹è½½å¤§å°ï¼‰ çš„ Appï¼Œ ä½†éœ€è¦ç”¨æˆ·ã€Œè®¾ç½®ã€é€‰æ‹©ç­–ç•¥ï¼Œé»˜è®¤ä¸ºã€Œè¶…è¿‡ 200MB è¯·æ±‚è®¸å¯ã€ï¼ˆåœ¨è®¾ç½®->APPStore->APP ä¸‹è½½ä¸­å¯æ›´æ”¹ï¼‰ã€‚

![image.png](https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3dc44c103e154dea90f1919db9709712~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&x-expires=1727931961&x-signature=qgmmodM3zl4cWi2kJY%2FmGmdjnm4%3D)

![image.png](https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cea3ace159224a2593731501d91c65c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&x-expires=1727931961&x-signature=hc9LyzgJI%2BRu65K6A7AiBiEsgzM%3D)

#### ä¸‰ã€æ²»ç†æ€è·¯

æˆ‘ä»¬éƒ¨é—¨çš„APPæ˜¯2021å¹´èµ·æ­¥ï¼Œæ‹‰æ–°æ˜¯é‡è¦çš„å·¥ä½œä¹‹ä¸€ã€‚2017å¹´Google Playçš„ä¸€ä¸ªç ”ç©¶ç»“æœæ˜¯**åŒ…ä½“å¤§å°æ¯ä¸Šå‡6MBï¼Œåº”ç”¨ä¸‹è½½è½¬åŒ–ç‡å°±ä¼šä¸‹é™1%ï¼Œ**Â å› æ­¤æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è·Ÿè¡Œä¸šå¤´éƒ¨çš„APPä¸­å¯¹æ¯”ç»´æŒè¾ƒä½çš„åŒ…ä½“ç§¯ã€‚

ç”±äºåŒ…ä½“ç§¯å¤§å°éšç€åŠŸèƒ½è¿­ä»£ä¸­å¢åŠ åˆ é™¤ä»£ç ã€å›¾ç‰‡ã€èµ„æºæ–‡ä»¶è€Œå‘ç”Ÿå˜åŒ–çš„ï¼Œæ‰€ä»¥åŒ…ä½“ç§¯æ²»ç†ä¹Ÿæ˜¯ä¸€ä¸ªåŠ¨æ€çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬çš„æ²»ç†æ€è·¯æ˜¯ï¼Œå¯¹åŒ…ä½“ç§¯æƒ…å†µåˆ†æåˆ†å¤šæœŸæ²»ç†è¾¾åˆ°ç›®æ ‡ï¼Œå¹¶ä¸”åœ¨åŠŸèƒ½è¿­ä»£ä¸­æŒç»­ç›‘æ§é¿å…åŠ£åŒ–ï¼Œå°å¹…çš„æ³¢åŠ¨å¾…ç´¯è®¡åå‘¨æœŸæ€§åšä¸€æ¬¡ä¼˜åŒ–ã€‚

![image.png](https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2473ec3eae4e4a98858c02ee0b91b0ce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&x-expires=1727931961&x-signature=eTf9jXp0LYrdT3nn8ve%2BiB6cX0Q%3D)

#### å››ã€åˆ†æipaåŒ…æ„æˆ

åœ¨è¿›è¡Œä¼˜åŒ–å‰ï¼Œå¼„æ¸…æ¥š`ipa`å®‰è£…åŒ…é‡Œé¢æœ‰å“ªäº›å†…å®¹å¾ˆé‡è¦ã€‚é¦–å…ˆå¯¹`ipa`åŒ…è¿›è¡Œè§£å‹ï¼Œè§£å‹åå¯¹æ–‡ä»¶è¿›è¡Œå½’ç±»ç»Ÿè®¡ï¼Œç„¶åé’ˆå¯¹å„ä¸ªç±»å‹çš„æ–‡ä»¶å‘ç°å’Œæ€è€ƒä¼˜åŒ–ç©ºé—´ã€‚å¦‚ä¸‹æ˜¯æŸä¸ªç‰ˆæœ¬çš„å„éƒ¨åˆ†æ–‡ä»¶å æ¯”æƒ…å†µï¼š

![image.png](https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c241e676556a44acb3e459710f9cd0cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&x-expires=1727931961&x-signature=uC2Ze%2BU5W7YID%2BRb6MzXumOmwdw%3D)

ç”±ä¸Šï¼Œç»“åˆåŒ…ä½“ç§¯ä¼˜åŒ–çš„ä¸€äº›èµ„æ–™ï¼Œæˆ‘ä»¬å¤§ä½“ç¡®å®šäº†ä»¥ä¸‹å‡ ä¸ªæ€è·¯ï¼š

![image.png](https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0a4e51ebbe247d4a9d642dc16d90009~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&x-expires=1727931961&x-signature=%2B%2FIH82SXNF2yr%2FRWR3RW6j%2Bewx0%3D)

åŒ…ä½“ç§¯ä¼˜åŒ–çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œä»¥ä¸‹æ˜¯æˆ‘ä»¬ç»¼åˆè€ƒè™‘`ROI`ã€é£é™©ã€ç”¨æˆ·ä½“éªŒç­‰å› ç´ çš„ä¸€äº›å®è·µï¼Œä»`Mach-O`ä¼˜åŒ–ã€èµ„æºæ–‡ä»¶ä¼˜åŒ–ã€ç¼–è¯‘è®¾ç½®ä¼˜åŒ–3ä¸ªæ–¹é¢è®²è¿°ã€‚

#### äº” ã€Mach-Oä¼˜åŒ–

å®‰è£…åŒ…ä¸­åŒ…å«çš„`Mach-O`æ–‡ä»¶åŒ…æ‹¬ä¸»å·¥ç¨‹å¯æ‰§è¡Œæ–‡ä»¶ã€åŠ¨æ€åº“`Mach-O`æ–‡ä»¶ã€‚`Mach-O`æ–‡ä»¶æ˜¯æ ¹æ®ä»£ç ç”Ÿæˆçš„ï¼Œæ‰€ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹å‘ä¼˜åŒ–ã€‚

##### **1. æ— ç”¨ä»£ç æ¸…ç†**

- `ABTest`çš„ä»£ç åœ¨å®éªŒç»“æŸååŠæ—¶ä¸‹æ‰
- ä¸€äº›æœªä½¿ç”¨çš„æ–¹æ³•å’Œç±»æ–‡ä»¶æ¸…ç†ã€‚
- `Debug`ä¸‹æ‰ä½¿ç”¨çš„åº“å’Œä»£ç è®¾ç½®ä¸º`Debug`ç”Ÿæ•ˆã€‚`Pod`åº“åœ¨`Podfile`ä¸­é…ç½®ä¸º`Debug`ä¸‹ç”Ÿæ•ˆçš„æ–¹æ³•å¦‚ä¸‹ï¼š

ruby

ä»£ç è§£è¯»

å¤åˆ¶ä»£ç 

`# 1.Podfileä¸­å¯ä»¥é…ç½®åº“åªåœ¨debugä¸‹é›†æˆï¼Œ # åœ¨releaseä¸‹æ‰“åŒ…æ—¶ä¸ä¼šåµŒå…¥åˆ°å®‰è£…åŒ…ä¸­ï¼Œé¿å…åŒ…ä½“ç§¯å¢å¤§ target 'User' do pod 'UICompare',   '0.1.5',     :configurations => ['Debug'] pod 'FLEX',          '5.22.10',   :configurations => ['Debug'] pod 'SwiftLint',     '~> 0.43.1', :configurations => ['Debug'] ... end # 2.å¦‚æœæœ‰çš„åº“é‡Œé¢æŸä¸ªæ–‡ä»¶å¤¹çš„å†…å®¹æ²¡ç”¨åˆ°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨hookæ¥åˆ é™¤ pre_install do |installer| # åŒ…ä½“ç§¯ä¼˜åŒ–å»æ‰AFNetworkingä¸­æ²¡ç”¨åˆ°çš„UIKit+AFNetworkingæ–‡ä»¶å¤¹ä¸­å†…å®¹ system("rm -rf ./Pods/AFNetworking/UIKit+AFNetworking") end`

##### 2.Â **é‡å¤ä»£ç æ•´åˆ**

- æ•´åˆç›¸åŒåŠŸèƒ½åº“ï¼Œæ¯”å¦‚`SDWebImage`å’Œ`Kingfisher`å¯ç»Ÿä¸€ä½¿ç”¨ä¸€ä¸ªã€‚
- iOSå·¥ç¨‹ç»„ä»¶åŒ–ä¹‹åï¼Œä¸åŒPodåº“ä½¿ç”¨äº†ç›¸åŒçš„åŠŸèƒ½ç±»ï¼Œå¯¼è‡´é‡å¤ã€‚

> - æƒ…å†µä¸€ï¼šæ”¹äº†ç±»åå’Œæ–‡ä»¶å
> 
> æ¯”å¦‚`Aspects`åº“hookåŠŸèƒ½ï¼Œæœ‰çš„åº“æ‹·è´äº†ä¸€ä»½ï¼Œåˆå› ä¸ºè¦é¿å…å¯èƒ½å‘ç”Ÿçš„ç¬¦å·å†²çªï¼Œå°†ç±»åå’Œæ–‡ä»¶åæ”¹å†™ã€‚
> 
> è¿™ç§æƒ…å†µä¸å®¹æ˜“æŸ¥æ‰¾ï¼Œä¾èµ–å¼€å‘è€…åœ¨éœ€æ±‚å¼€å‘è¿‡ç¨‹ä¸­å‘ç°åå…ˆæ ‡è®°ï¼Œåœ¨åç»­çš„åŒ…ä½“ç§¯ä¼˜åŒ–éœ€æ±‚ä¸­è€ƒè™‘å°†æ–‡ä»¶ä¸‹æ²‰ã€‚

> - æƒ…å†µäºŒï¼šæœªä¿®æ”¹ç±»åå’Œæ–‡ä»¶åï¼Œæ”¾åœ¨åŠ¨æ€åº“ä¸­
> 
> Swiftå·¥ç¨‹ä¸­å¤šä¸ªåŠ¨æ€åº“ä¾èµ–äº†ç›¸åŒçš„åŠŸèƒ½ï¼Œå„è‡ªæŠŠé‚£äº›æ–‡ä»¶æ‹·è´äº†ä¸€ä»½åœ¨å…¶å†…éƒ¨ã€‚
> 
> æ³¨æ„ğŸ“¢ï¼šå¦‚æœæ˜¯OCæ–‡ä»¶ï¼Œç”ŸæˆPodåŠ¨æ€åº“æ—¶ä¹Ÿä¸ä¼šå‘ç”Ÿç¬¦å·å†²çªï¼›å¦‚æœæ˜¯Swiftæ–‡ä»¶ï¼Œæœ‰å‘½åç©ºé—´ä¸ä¼šå‘ç”Ÿç¬¦å·å†²çªã€‚
> 
> è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ˜¯Swiftæ–‡ä»¶ï¼Œéœ€è¦æ‰‹åŠ¨æ’æŸ¥ï¼›å¦‚æœæ˜¯ç›¸åŒçš„OCç¬¦å·åœ¨ä¸åŒçš„Mach-Oä¸­ï¼ˆå³ä¸»å·¥ç¨‹å¯æ‰§è¡Œæ–‡ä»¶å’ŒåŠ¨æ€åº“çš„Mach-Oæ–‡ä»¶ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è°ƒè¯•è¿è¡Œæ—¶åœ¨Xcodeæ§åˆ¶å°æ‰“å°çœ‹åˆ°ã€‚æ¨èæ”¹æ³•ä¹Ÿæ˜¯ä¸‹æ²‰åˆ°åŸºç¡€åº“ä¸­ã€‚
> 
> > ![](https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c5661e5f4884c43b0c0e811bf581c64~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&x-expires=1727931961&x-signature=8CtEiM%2F9RVj2MxC6IWyhcpIxjLU%3D)

##### **3. åŠ¨æ€åº“æ”¹é™æ€åº“**

- **æ”¹æ³•æ¥ç”±**

æˆ‘ä»¬å¯ä»¥åœ¨`ipa`åŒ…ä¸­çš„`Frameworks`æ–‡ä»¶å¤¹ä¸­æŸ¥çœ‹æ‰€æœ‰çš„åŠ¨æ€åº“ï¼ŒåŠ¨æ€åº“ç›¸æ¯”é™æ€åº“ä¼šå ç”¨æ›´å¤§ç©ºé—´ï¼›å¦ä¸€æ–¹é¢è¿‡å¤šçš„åŠ¨æ€åº“æ•°é‡ä¹Ÿä¼šå½±å“å¯åŠ¨é€Ÿåº¦ï¼Œè‹¹æœå®˜æ–¹çš„æ¨èæ˜¯ä¸è¶…è¿‡6ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä¸€äº›åº“æ”¹ä¸ºé™æ€åº“ã€‚

> "ç½‘æ˜“äº‘éŸ³ä¹åŒ…ä½“ç§¯ä¼˜åŒ–"çš„ä¸€ä¸ªcaseï¼šåœ¨ä¸»ç¨‹åºä¸­ã€åŠ¨æ€åº“Aä¸­ã€åŠ¨æ€åº“Bä¸­åˆ†åˆ«æœ‰ä¸€ä»½OpenSSLçš„ç¬¦å·ï¼Œè¿™å°±é€ æˆäº†é‡å¤ï¼Œå ç”¨äºŒè¿›åˆ¶ä½“ç§¯ã€‚è¿™ç§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯åŠ¨è½¬é™ï¼ŒæŠŠåŠ¨æ€åº“è½¬åŒ–ä¸ºé™æ€åº“ï¼Œéƒ½é“¾æ¥åœ¨ä¸»ç¨‹åºä¸­ï¼Œè§£é™¤åŸæ¥çš„ä¾èµ–ï¼Œéƒ½ä½¿ç”¨ä¸»äºŒè¿›åˆ¶ä¸­çš„Symbolã€‚
> 
> ä½¿ç”¨`hopper`æ‰“å¼€åŠ¨æ€åº“æˆ‘ä»¬å¯ä»¥çœ‹åˆ°`AFNetworking`å’Œ`SDWebImage`åŠ¨æ€åº“é‡Œé¢æœ‰å…³ä¸€äº›åŸºç¡€çš„ä½¿ç”¨æ–¹æ³•å­˜åœ¨é‡å¤Nameï¼Œå´ä¸åŒçš„`Address`ï¼Œæ¯”å¦‚è¿™ä¸ª`dispatch_once`ã€‚

![image.png](https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6089a7ca37f747f1b5ba0c4b9f8ee7c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&x-expires=1727931961&x-signature=7G%2FfrLAqMlg0WwJF%2F2XFy3qca6A%3D)

- **ä¿®æ”¹æ–¹å¼**

APPå·¥ç¨‹æ˜¯ç»„ä»¶åŒ–å¼€å‘çš„ï¼Œæœ‰100å¤šä¸ª`Pod`åº“ï¼Œç»è¿‡åˆ†æåé‡‡ç”¨äº†ä¸¤ç§ä¿®æ”¹çš„æ–¹å¼ï¼š

> æœ‰çš„å…¬å¸åœ¨å…¨é¢æ”¹ä¸º`XCFramework`ä¹‹åï¼Œçœ‹æºç ä¸æ–¹ä¾¿ï¼Œæ”¹ä»£ç ååˆéœ€è¦ç”Ÿæˆæ–°çš„`XCFramework`åº“ç‰ˆæœ¬ï¼Œå¯¼è‡´å¼€å‘æ•ˆç‡ä½ï¼Œç»§è€Œå…¨é¢å»é™¤.....
> 
> ç»¼åˆè€ƒè™‘ï¼Œæˆ‘ä»¬è¿™è¾¹çš„åšæ³•æ˜¯ï¼š
> 
> - ä»…ä»…æŠŠç‰ˆæœ¬ç›¸å¯¹å›ºå®šçš„ä¸‰æ–¹åº“ç”Ÿæˆ`XCFramework`ï¼Œè¿™æ ·å¯ä»¥äº«å—åˆ°æ­£å‘æ”¶ç›Šã€‚é€šè¿‡è„šæœ¬ç”Ÿæˆå¯¹åº”podåº“çš„xcframeworkçš„Podåº“ç‰ˆæœ¬ï¼Œç‰ˆæœ¬å·çº¦å®šä¸ºåŸå…ˆpodåº“çš„ç‰ˆæœ¬ååŠ ä¸€ä¸ª`-xcbinary`åç¼€ï¼Œè¿™æ ·å…å»æ‰‹åŠ¨ç”Ÿæˆxcframeworkçš„éº»çƒ¦ã€‚åœ¨éœ€è¦çœ‹æºç è°ƒè¯•æ—¶ï¼Œåªéœ€è¦å°†å¯¹åº”Podåº“ç‰ˆæœ¬å·åç¼€å»æ‰ã€‚
> - å¯¹äºæ”¹åŠ¨æ›´é¢‘ç¹çš„äºŒæ–¹åº“ï¼Œæˆ‘ä»¬ä¿æŒæºç ç‰ˆæœ¬çš„podåº“ï¼Œå¹¶ä¸”åœ¨`Podspec`ä¸­å£°æ˜ä¸º`s.static_framework =`Â **`true`**Â **,**Â ç¼–è¯‘ç”Ÿæˆäº§ç‰©ä¸ºé™æ€åº“ï¼Œè¿™æ ·åŒ…ä½“ç§¯ç›¸æ¯”åŠ¨æ€åº“æ›´å°.

#### å…­ã€èµ„æºæ–‡ä»¶ä¼˜åŒ–

1. ##### æ— ç”¨èµ„æºæ¸…ç†
- ä½¿ç”¨[LSUnusedResource](https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ftinymind%2FLSUnusedResources "https://github.com/tinymind/LSUnusedResources")å·¥å…·è¿›è¡Œæœªä½¿ç”¨èµ„æºæ£€æŸ¥æ¸…ç†ã€‚

- @1xå›¾æ ‡æ˜¯iPhone4ä»¥ä¸‹è®¾å¤‡æ‰ä½¿ç”¨çš„ï¼Œç›®å‰ä¸éœ€è¦ï¼Œå¯ä»¥æ¸…ç†@1xå›¾æ ‡ã€‚
2. ##### é‡å¤èµ„æº
- ç›¸åŒçš„å›¾æ ‡å¤šä¸ªåº“éƒ½æœ‰ä¸€ä»½å¯ä»¥è€ƒè™‘ä½¿ç”¨åŒä¸€ä¸ªã€‚
- Podåº“ä¸­çš„èµ„æºç”Ÿæˆæ–¹å¼

> ä½¿ç”¨Cocoapodsç®¡ç†é›†æˆä¸‰æ–¹åº“æ—¶ï¼Œå¦‚æœPodåº“çš„resourcesé›†æˆæ–¹å¼ä¸å¯¹ï¼Œä¼šå¸¦æ¥çš„å›¾ç‰‡é‡å¤åˆå¹¶é—®é¢˜ã€‚

ini

ä»£ç è§£è¯»

å¤åˆ¶ä»£ç 

 `# podspecä¸­èµ„æºç”Ÿæˆçš„æ–¹å¼: # ç¬¬ä¸€ç§ï¼š # æ˜¯ä¸åº”è¯¥ä½¿ç”¨çš„æ–¹å¼ï¼Œ iOS ä¼˜åŒ–IPAåŒ…ä½“ç§¯ï¼ˆä»Šæ—¥å¤´æ¡ï¼‰ æ–‡ç« ä¸­è¯´ï¼Œ # * å¦‚æœæ˜¯xcassetsï¼Œä¼šå¯¼è‡´asset catalogä¸­çš„å›¾ç‰‡ï¼Œ # æ—¢ä½œä¸ºasset catalogè¢«åˆå¹¶åˆ°ä¸»å·¥ç¨‹çš„asset.carä¸­ï¼Œ # ä¹Ÿä¼šä½œä¸ºpngè¢«æ‹·è´åˆ°å®‰è£…åŒ…é›¶æ•£çš„å­˜åœ¨ä¸­,å¯¼è‡´å…¶ä¸­ä¸€å¥—å›¾ç‰‡ç™½ç™½å ç”¨äº†å®‰è£…åŒ…ç©ºé—´ã€‚ s.resources = ['Home/Assets/**/*.{xcassets,png,xib}'] # ç¬¬äºŒç§ï¼š # åº”è¯¥ä½¿ç”¨çš„ï¼Œå¹¶ä¸”å›¾ç‰‡æ¨èæ–°å»ºä¸€ä¸ªxcassetsï¼Œå› ä¸ºè¿™æ ·ä»è‹¹æœçš„ç˜¦èº«æœºåˆ¶å—ç›Šã€‚ # è¯»å–podä¸­å›¾ç‰‡çš„æ–¹å¼ï¼š # ä½¿ç”¨æ—¶æ˜¯åŠ¨æ€åº“ï¼Œé‚£ä¹ˆéœ€è¦ä»mianBundleä¸­è·å–Frameworks/Home.framework/Home.bundleç„¶åè¯»å– # ä½¿ç”¨æ—¶æ˜¯é™æ€åº“ï¼Œéœ€è¦ä»mianBundleä¸­è·å–Home.bundleç„¶åè¯»å– s.resource_bundles = {   'Home' => ['Home/{Assets,Classes}/**/*.{xcassets,png,xib}']  } # ç¬¬ä¸‰ç§ # ä¸Šè¿°ç¬¬äºŒç§ä¸­çš„æ–¹å¼è·Ÿä¸‹é¢è¿™ä¸ªæ–¹æ³•æ˜¯ç­‰ä»·çš„ï¼Œä¸‹é¢çš„æ–¹æ³•æ˜¯è‡ªå·±æ‰‹åŠ¨åˆ›å»ºbundle  s.resources = ['Home/Home.bundle']`

- ipaåŒ…ä¸­æ£€æŸ¥å„ä¸ªbundleé‡Œé¢ï¼Œçœ‹å›¾ç‰‡ã€Xibæ˜¯å¦æ‰“åŒ…åé‡å¤äº†ã€‚

![](https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc5c7f1f6a754121a51dd651ec21954a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&x-expires=1727931961&x-signature=bshfqz%2BnilIgVgyjT5qinMU3zek%3D)

ini

ä»£ç è§£è¯»

å¤åˆ¶ä»£ç 

`# ç»è¿‡æ’æŸ¥ï¼Œå‘ç°æ˜¯PodSpecæ–‡ä»¶ä¸­èµ„æºçš„å†™æ³•å¯¼è‡´çš„ # 1ã€äº§ç”Ÿé—®é¢˜çš„å†™æ³•   s.resource_bundles = {     'Home' => ['Home/Assets/**/*']   } # 2ã€æ”¹ä¸ºå†™æ³•å°±okäº†   s.resource_bundles = {     'Home' => ['Home/{Assets,Classes}/**/*.{xcassets,png,xib}']   }`

3. #### å›¾ç‰‡å‹ç¼©

ä½¿ç”¨äº†`ImageOptim`å·¥å…·æ¥è¿›è¡Œ70%çš„å¾®é‡æœ‰æŸå‹ç¼©ã€‚

4. ##### æ›´ä½åŒ…ä½“ç§¯æ ¼å¼å›¾ç‰‡æ ¼å¼
- **jpg**ï¼šåŒæ ·æ˜¯éœ€è¦@2xã€@3xçš„å›¾æ ‡ï¼Œäº«å—ä¸åˆ°`AppThinning`

- **webP**ï¼šäº«å—ä¸åˆ°`AppThinning`ï¼Œä¸”éœ€è¦é¢å¤–ä¾èµ–webP.framework.

- **HEIC**ï¼šiOS 12ä»¥ä¸Šæ”¯æŒï¼Œå°†å›¾ç‰‡è½¬ä¸º`HEIC`åæ”¾å…¥åˆ°`Asset Catalog`ä¸­, åŠ è½½æ–¹å¼è·Ÿpngå›¾ç‰‡ä¸€è‡´ï¼Œå¯¹äºå¤§å›¾ç‰‡æ•ˆæœå¾ˆæ˜æ˜¾ï¼ˆ75%å·¦å³ï¼‰ã€‚ä½†è½¬ä¸ºheicä¹Ÿè¦æµ‹è¯•å…¼å®¹æ€§ï¼Œç‰¹åˆ«æ˜¯æ¸å˜é€æ˜è‰²çš„å›¾æ ‡ï¼Œéœ€è¦æŸ¥çœ‹ä½ç‰ˆæœ¬ç³»ç»Ÿæ˜¾ç¤ºæ˜¯å¦æœ‰è‰²å·®ã€‚
5. ##### Asset Catalogç®¡ç†

æœ‰çš„å›¾æ ‡å¯èƒ½ä¼šæ”¾åœ¨æ–‡ä»¶å¤¹æˆ–è€…bundleä¸­ï¼Œä½†æ¨èæŠŠå›¾æ ‡æ”¾åˆ°`Asset Catalog`ç®¡ç†ï¼Œè¿™æ ·èƒ½ä»è‹¹æœApp Storeç˜¦èº«æœºåˆ¶å—ç›Šã€‚æ³¨æ„ï¼Œæ‰“åŒ…ç”Ÿæˆçš„ipaå¯èƒ½ä¼šå˜å¤§ï¼Œéœ€è¦åœ¨App Store connectä¸­æŸ¥çœ‹å˜ä½“ç‰ˆæœ¬çš„å®‰è£…åŒ…å¤§å°æ‰èƒ½çœ‹åˆ°å®é™…æ”¶ç›Šã€‚

6. ##### èµ„æºæŒ‰éœ€åŠ è½½
- [On-Demand Resource](https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.apple.com%2Flibrary%2Farchive%2Fdocumentation%2FFileManagement%2FConceptual%2FOn_Demand_Resources_Guide%2Findex.html%23%2F%2Fapple_ref%2Fdoc%2Fuid%2FTP40015083-CH2-SW1 "https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/On_Demand_Resources_Guide/index.html#//apple_ref/doc/uid/TP40015083-CH2-SW1")ï¼š å°†å›¾ç‰‡èµ„æºè®¾ç½®ä¸ºæŒ‰éœ€èµ„æºï¼Œä¸ä¼šæ‰“åŒ…è¿›ipaï¼Œåœ¨ä½¿ç”¨æ—¶ä»App Storeä¸­ä¸‹è½½èµ„æºï¼ˆæ›´é€‚ç”¨äºå‡çº§æ¸¸æˆåº”ç”¨ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨APPæ—¶åªéœ€åŠ è½½ç”¨æˆ·å…³è”çš„å‡ ä¸ªç­‰çº§çš„èµ„æºï¼‰ã€‚

- å¯ä»¥è€ƒè™‘åœ¨ä¸å½±å“ç”¨æˆ·ä½“éªŒçš„æƒ…å†µä¸‹ï¼ŒæŠŠæœ¬åœ°çš„å¤§å›¾ã€åŠ¨æ€å›¾ã€`Lotties`åŠ¨ç”»æ”¾åˆ°æœåŠ¡å™¨ç«¯ã€‚

#### ä¸ƒã€ç¼–è¯‘è®¾ç½®ä¼˜åŒ–

ç¼–è¯‘è®¾ç½®ä¼˜åŒ–æ—¶ï¼Œå»ºè®®åœ¨`Podfile`çš„`post_install`å‡½æ•°ä¸­è®¾ç½®ä¸»å·¥ç¨‹å’Œ`Pod`çš„ç¼–è¯‘è®¾ç½®ï¼Œè¿™æ ·èƒ½è®©å„ä¸ª`Pod`åº“ä¹Ÿç”Ÿæ•ˆï¼Œä¹Ÿèƒ½åšåˆ°ä»…ä»…è®¾ç½®æ‰“åŒ…ç¯å¢ƒæ˜¯ç”Ÿæ•ˆä¸å½±å“ç¼–è¯‘è°ƒè¯•è€—æ—¶ï¼

1. ##### **GCCç¼–è¯‘ä¼˜åŒ–**

é€šè¿‡GCCç¼–è¯‘ä¼˜åŒ–ï¼Œäº§ç”Ÿä½“ç§¯æ›´å°çš„äºŒè¿›åˆ¶äº§ç‰©ï¼Œå¯¹`OC`ã€`C`ã€`C++`éƒ½æœ‰æ•ˆæœã€‚

ç¼–è¯‘ä¼˜åŒ–é…ç½®è·¯å¾„ä¸ºï¼š`Build Settings`Â ->Â `Apple Clang`Â -Â `Code Generation`Â ->Â `Optimize Level`

| å±æ€§å€¼    | å¤§ä½“è¯´æ˜                                                                               |
| ------ | ---------------------------------------------------------------------------------- |
| -O0    | ä¸åšä¼˜åŒ–                                                                               |
| -Oï¼ŒO1  | ç¼–è¯‘å™¨è¯•å›¾å‡å°‘ä»£ç å¤§å°å’Œæ‰§è¡Œæ—¶é—´ï¼Œè€Œä¸æ‰§è¡Œä»»ä½•å ç”¨å¤§é‡ç¼–è¯‘æ—¶é—´çš„ä¼˜åŒ–ã€‚                                                |
| -O2    | GCCæ‰§è¡Œå‡ ä¹æ‰€æœ‰æ”¯æŒçš„ä¼˜åŒ–ï¼Œè¿™äº›ä¼˜åŒ–ä¸æ¶‰åŠç©ºé—´-é€Ÿåº¦æŠ˜è¡·ã€‚ä¸-Oç›¸æ¯”ï¼Œæ­¤é€‰é¡¹å¢åŠ äº†ç¼–è¯‘æ—¶é—´å’Œç”Ÿæˆä»£ç çš„æ€§èƒ½ã€‚ç¼–è¯‘å™¨ä¸è¿›è¡Œå¾ªç¯å±•å¼€ã€å†…è”å‡½æ•°å’Œå¯„å­˜å™¨å˜é‡çš„é‡å‘½å   |
| -O3    | æ‰“å¼€-O2æŒ‡å®šçš„æ‰€æœ‰ä¼˜åŒ–ï¼Œå¼€å¯å†…è”å‡½æ•°å’Œå¯„å­˜å™¨é‡å‘½åé€‰é¡¹ã€‚                                                      |
| -Os    | å¯ç”¨æ‰€æœ‰-O2ä¼˜åŒ–ï¼Œé™¤äº†é‚£äº›ç»å¸¸å¢åŠ ä»£ç å¤§å°çš„ä¼˜åŒ–ã€‚å®ƒè¿˜å¯ç”¨äº†-finlineå‡½æ•°ï¼Œä½¿ç¼–è¯‘å™¨æ ¹æ®ä»£ç å¤§å°è€Œä¸æ˜¯æ‰§è¡Œé€Ÿåº¦è¿›è¡Œè°ƒæ•´ï¼Œå¹¶æ‰§è¡Œæ—¨åœ¨å‡å°‘ä»£ç å¤§å°çš„è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚ |
| -Ofast | æ”¯æŒæ‰€æœ‰-O3ä¼˜åŒ–ã€‚å®ƒè¿˜å¯ç”¨äº†å¹¶éå¯¹æ‰€æœ‰ç¬¦åˆæ ‡å‡†çš„ç¨‹åºéƒ½æœ‰æ•ˆçš„ä¼˜åŒ–ã€‚                                                 |
| -Oz    | é’ˆå¯¹å¤§å°è€Œéé€Ÿåº¦è¿›è¡Œç§¯æä¼˜åŒ–ã€‚å¦‚æœè¿™äº›æŒ‡ä»¤éœ€è¦æ›´å°‘çš„å­—èŠ‚æ¥ç¼–ç ï¼Œåˆ™è¿™å¯ä»¥å¢åŠ æ‰§è¡Œçš„æŒ‡ä»¤çš„æ•°é‡-Ozçš„è¡Œä¸ºä¸-Osç±»ä¼¼ï¼ŒåŒ…æ‹¬å¯ç”¨å¤§å¤šæ•°-O2ä¼˜åŒ–ã€‚           |

æˆ‘ä»¬ä½¿ç”¨`-Oz`ï¼Œå³`releaseä¸‹`è®¾ç½®`GCC_OPTIMIZATION_LEVEL = z;`åå¯ä»¥æ‰§è¡ŒåŒ…ä½“ç§¯ä¸Šçš„ä¼˜åŒ–ã€‚

> -Ozè¿›ä¸€æ­¥è¯´æ˜ï¼šåœ¨ Xcode 11 ä¹‹åæä¾›çš„ç¼–è¯‘ä¼˜åŒ–å‚æ•° ï¼Œå®ƒé€šè¿‡è¯†åˆ«å•ä¸ªç¼–è¯‘å•å…ƒä¸­è·¨å‡½æ•°çš„ç›¸åŒä»£ç åºåˆ—æ¥å‡å°‘ä»£ç å¤§å°ã€‚è¿™äº›åºåˆ—åœ¨å•ä¸ªç¼–è¯‘å™¨ç”Ÿæˆçš„å‡½æ•°ä¸­è¢«å°è£…ï¼ˆOutlinedï¼‰ã€‚æ¯ä¸ªåŸå§‹ä»£ç åºåˆ—éƒ½è¢«æ›¿æ¢ä¸ºè°ƒç”¨è¯¥ Outlined å‡½æ•°ã€‚ä¼šå‡å°ç›¸åŒä»£ç å­˜åœ¨å¤šä»½é—®é¢˜ï¼Œä½†æ˜¯ä¹Ÿä¼šä½¿å¾—çš„å‡½æ•°è°ƒç”¨å­˜åœ¨æ›´æ·±çš„è°ƒç”¨æ ˆï¼Œå¯¹å®¢æˆ·ç«¯æ€§èƒ½è¾ƒå°ã€‚

2. ##### **Swift ç¼–è¯‘å™¨çš„ä¼˜åŒ–çº§åˆ«**

`SWIFT_OPTIMIZATION_LEVEL`æ˜¯ä¸€ä¸ª Swift è¯­è¨€ç›¸å…³çš„æ„å»ºè®¾ç½®ï¼Œç”¨äºæŒ‡å®š Swift ç¼–è¯‘å™¨åœ¨ç¼–è¯‘ iOS é¡¹ç›®æ—¶åº”è¯¥ä½¿ç”¨çš„ä¼˜åŒ–çº§åˆ«ã€‚

| `SWIFT_OPTIMIZATION_LEVEL`è®¾ç½® | å¤§ä½“è¯´æ˜                                         |
| ---------------------------- | -------------------------------------------- |
| `-Onone`                     | é€‚ç”¨äºDebugè®¾ç½®ã€‚æ— ä¼˜åŒ–ï¼Œä¿ç•™æ‰€æœ‰çš„è°ƒè¯•ä¿¡æ¯ï¼Œä¸è¿›è¡Œä»»ä½•ä¼˜åŒ–ï¼Œä»¥æä¾›æœ€ä½³çš„è°ƒè¯•ä½“éªŒã€‚ |
| `-O`ï¼ˆé»˜è®¤å€¼ï¼‰                    | é€‚ç”¨äºreleaseè®¾ç½®ã€‚è¿›è¡Œå±€éƒ¨çš„ä¼˜åŒ–åŒ…æ‹¬å¾ªç¯ä¼˜åŒ–ã€å†…è”ç­‰ï¼Œä½†ä¸è¿›è¡Œæ•´ä¸ªæ¨¡å—çš„ä¼˜åŒ–ã€‚  |
| `-Osize`                     | é€‚ç”¨äºreleaseè®¾ç½®ã€‚ä¼˜åŒ–ä»¥å‡å°ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶çš„å¤§å°ã€‚               |

ç”±ä¸Šï¼Œå°†å·¥ç¨‹å’Œpodåº“çš„ç¼–è¯‘è®¾ç½®æ”¹ä¸º`-Osize`ã€‚

é…åˆä½¿ç”¨çš„è¿˜æœ‰`Compliation Mode`è®¾ç½®ï¼Œå¯ä»¥åœ¨releaseè®¾ç½®ä¸º`wholemodule`

| `Compliation Mode`è®¾ç½® | å¤§ä½“è¯´æ˜                                                                        |
| -------------------- | --------------------------------------------------------------------------- |
| singlefile           | å•ä¸ªæ–‡ä»¶ä¼˜åŒ–ï¼Œ**å¯ä»¥å‡å°‘å¢é‡ç¼–è¯‘çš„æ—¶é—´**ï¼Œå¹¶ä¸”å¯ä»¥å……åˆ†åˆ©ç”¨å¤šæ ¸ CPUï¼Œå¹¶è¡Œä¼˜åŒ–å¤šä¸ªæ–‡ä»¶ï¼Œæé«˜ç¼–è¯‘é€Ÿåº¦ã€‚ä½†æ˜¯å¯¹äºäº¤å‰å¼•ç”¨æ— èƒ½ä¸ºåŠ›ã€‚é€‚åˆDebug. |
| wholemodule          | æ¨¡å—ä¼˜åŒ–ï¼Œ**æœ€å¤§é™åº¦ä¼˜åŒ–æ•´ä¸ªæ¨¡å—**ï¼Œèƒ½å¤„ç†äº¤å‰å¼•ç”¨ã€‚ç¼ºç‚¹ä¸èƒ½åˆ©ç”¨å¤šæ ¸ CPU çš„ä¼˜åŠ¿ï¼Œæ¯æ¬¡ç¼–è¯‘éƒ½ä¼šé‡æ–°ç¼–è¯‘æ•´ä¸ª Moduleï¼›é€‚åˆRelease. |

3. ##### **LTO-é“¾æ¥æœŸä¼˜åŒ–å‚æ•°è®¾ç½®**

> Link-Time Optimizationï¼ˆLTOï¼‰æ˜¯ä¸€ç§ç¼–è¯‘ä¼˜åŒ–æŠ€æœ¯ï¼Œå®ƒåœ¨é“¾æ¥é˜¶æ®µå¯¹æ•´ä¸ªç¨‹åºè¿›è¡Œå…¨å±€ä¼˜åŒ–ï¼Œè€Œä¸ä»…ä»…æ˜¯å•ä¸ªæºæ–‡ä»¶ã€‚è¿™æ„å‘³ç€ç¼–è¯‘å™¨èƒ½å¤Ÿåœ¨é“¾æ¥æ—¶çœ‹åˆ°æ•´ä¸ªç¨‹åºçš„ç»“æ„ï¼Œä»è€Œè¿›è¡Œæ›´å…¨é¢çš„ä¼˜åŒ–ã€‚
> 
> å…·ä½“æ¥è¯´ï¼ŒLTO æ‰§è¡Œä»¥ä¸‹ä¸»è¦ä»»åŠ¡ï¼š
> 
> 1. å…¨å±€ä¼˜åŒ–ï¼š LTO å…è®¸ç¼–è¯‘å™¨åœ¨æ•´ä¸ªç¨‹åºçº§åˆ«ä¸Šæ‰§è¡Œä¼˜åŒ–ã€‚è¿™åŒ…æ‹¬å…¨å±€çš„å¾ªç¯ä¼˜åŒ–ã€å†…è”å‡½æ•°ã€å‡å°‘å†—ä½™ä»£ç ç­‰ã€‚å› ä¸ºç¼–è¯‘å™¨èƒ½å¤Ÿçœ‹åˆ°æ•´ä¸ªç¨‹åºçš„ç»“æ„ï¼Œå®ƒå¯ä»¥æ›´å¥½åœ°ç†è§£ç¨‹åºçš„è¡Œä¸ºï¼Œä»è€Œè¿›è¡Œæ›´æ·±å…¥çš„ä¼˜åŒ–ã€‚
> 2. å†…è”ï¼š LTO å¯ä»¥æ›´å¥½åœ°è¿›è¡Œå‡½æ•°å†…è”ã€‚åœ¨é“¾æ¥æ—¶ï¼Œç¼–è¯‘å™¨å¯ä»¥å†³å®šæ˜¯å¦å°†å‡½æ•°çš„å†…å®¹ç›´æ¥æ’å…¥è°ƒç”¨è¯¥å‡½æ•°çš„åœ°æ–¹ï¼Œè€Œä¸ä»…ä»…æ˜¯ç”Ÿæˆä¸€ä¸ªå‡½æ•°è°ƒç”¨ã€‚è¿™å¯ä»¥å‡å°‘å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼Œæé«˜ç¨‹åºçš„æ€§èƒ½ã€‚
> 3. æ¶ˆé™¤æœªä½¿ç”¨çš„ä»£ç ï¼š ç¼–è¯‘å™¨å¯ä»¥æ›´å¥½åœ°è¯†åˆ«å’Œæ¶ˆé™¤æœªä½¿ç”¨çš„ä»£ç ã€‚åœ¨æ•´ä¸ªç¨‹åºçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç¼–è¯‘å™¨èƒ½å¤Ÿåˆ¤æ–­å“ªäº›ä»£ç å®é™…ä¸Šæ²¡æœ‰è¢«ä½¿ç”¨ï¼Œä»è€Œå‡å°ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶çš„å¤§å°ã€‚
> 4. å…¨å±€å˜é‡ä¼˜åŒ–ï¼š LTO ä¹Ÿå¯ä»¥è¿›è¡Œå…¨å±€å˜é‡çš„ä¼˜åŒ–ï¼ŒåŒ…æ‹¬åˆ é™¤æœªä½¿ç”¨çš„å…¨å±€å˜é‡å’Œä¼˜åŒ–å…¨å±€å˜é‡çš„å­˜å‚¨å¸ƒå±€ã€‚

æä¾›ä»¥ä¸‹å‡ ä¸ªé€‰é¡¹ï¼š

| å±æ€§           | å¤§ä½“è¯´æ˜                                                           |
| ------------ | -------------------------------------------------------------- |
| `No`         | ä¸å¼€å¯é“¾æ¥æœŸä¼˜åŒ–                                                       |
| `Monolithic` | - åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œæ•´ä¸ªç¨‹åºçš„ä¼˜åŒ–ä¿¡æ¯ä¼šè¢«æ†ç»‘åˆ°ä¸€ä¸ªå•ç‹¬çš„ LLVM Bitcode æ–‡ä»¶ä¸­ï¼Œé€šå¸¸ä½¿ç”¨Â `.lto`Â æ‰©å±•åã€‚ |

- è¿™ä¸ªå•ä¸€çš„æ–‡ä»¶åŒ…å«äº†æ•´ä¸ªç¨‹åºçš„æ‰€æœ‰ç¼–è¯‘å•å…ƒï¼ˆæ¨¡å—ï¼‰çš„ä¼˜åŒ–ä¿¡æ¯ã€‚
- åœ¨é“¾æ¥æ—¶ï¼Œç¼–è¯‘å™¨å¯ä»¥è¿›è¡Œå…¨å±€çš„ã€è·¨æ¨¡å—çš„ä¼˜åŒ–ã€‚
- è¿™ç§æ–¹å¼å¯ä»¥æä¾›æ›´é«˜æ°´å¹³çš„ä¼˜åŒ–ï¼Œä½†ç”Ÿæˆçš„Â `.lto`Â æ–‡ä»¶é€šå¸¸è¾ƒå¤§ã€‚ | |Â `Incremental`Â | - åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œä¼˜åŒ–ä¿¡æ¯è¢«åˆ†æ•£ä¿å­˜åœ¨å¤šä¸ªå°çš„ LLVM Bitcode æ–‡ä»¶ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å¯¹åº”ä¸€ä¸ªç¼–è¯‘å•å…ƒã€‚
- è¿™äº›å°æ–‡ä»¶é€šå¸¸ä½¿ç”¨Â `.o`Â æ‰©å±•åï¼Œå¹¶åŒ…å«äº†ç›¸åº”æ¨¡å—çš„ä¼˜åŒ–ä¿¡æ¯ã€‚
- åœ¨é“¾æ¥æ—¶ï¼Œåªæœ‰å®é™…éœ€è¦çš„æ¨¡å—ä¼šè¢«é‡æ–°ä¼˜åŒ–ã€‚
- è¿™ç§æ–¹å¼å¯ä»¥å‡å°æ¯æ¬¡é“¾æ¥æ—¶éœ€è¦å¤„ç†çš„æ•°æ®é‡ï¼Œç‰¹åˆ«é€‚ç”¨äºå¤§å‹é¡¹ç›®ã€‚
- Thin LTO æä¾›äº†ä¸€ç§æŠ˜è¡·æ–¹æ¡ˆï¼Œæ—¨åœ¨åœ¨æä¾›ä¸€å®šç¨‹åº¦ä¼˜åŒ–çš„åŒæ—¶ï¼Œå‡å°å®Œå…¨ LTO çš„ä¸€äº›å¼€é”€ã€‚ |

æˆ‘ä»¬åœ¨`release`ä¸‹é€‰æ‹©`Incremental`é€‰é¡¹ã€‚å¼€å¯è¿™ä¸ªä¼˜åŒ–åï¼Œä¸€æ–¹é¢å‡å°‘äº†æ±‡ç¼–ä»£ç çš„ä½“ç§¯ï¼Œä¸€æ–¹é¢æé«˜äº†ä»£ç çš„è¿è¡Œæ•ˆç‡ã€‚

4. ##### ä¸»äºŒè¿›åˆ¶å¯¹å¤–æš´éœ²ç¬¦å·

ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒiOS åº”ç”¨ç¨‹åºçš„ä¸»è¦é€»è¾‘å’ŒåŠŸèƒ½éƒ½æ˜¯åœ¨ä¸»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å®ç°çš„ã€‚ä¸ºäº†ç¡®ä¿åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ï¼Œä¸»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ç¬¦å·ä¿¡æ¯åº”è¯¥æ˜¯å†…éƒ¨çš„ï¼Œä¸åº”è¯¥ç›´æ¥æš´éœ²ç»™å¤–éƒ¨ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æ¶æ„ç”¨æˆ·æˆ–æ”»å‡»è€…ç›´æ¥è®¿é—®å’Œè°ƒç”¨åº”ç”¨ç¨‹åºä¸­çš„æ•æ„Ÿå‡½æ•°æˆ–å˜é‡ã€‚

`Xcode`Â ä¸­çš„Â `Symbols Hidden by Default`æ§åˆ¶æ˜¯å¦å°†ç¬¦å·é»˜è®¤éšè—ã€‚è®¾ç½®ä¸ºÂ `Yes`ï¼Œåˆ™Â `Xcode`Â ä¼šåœ¨æ„å»ºæ—¶ä½¿ç”¨Â `-fvisibility=hidden`Â é€‰é¡¹æ¥éšè—æ‰€æœ‰ç¬¦å·ã€‚è¿™æ„å‘³ç€ä¸»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ç¬¦å·ä¼šè¢«é™åˆ¶åœ¨å½“å‰ç¼–è¯‘å•å…ƒå†…éƒ¨å¯è§ï¼Œä¸ä¼šè¢«å…¶ä»–æ¨¡å—å¼•ç”¨ã€‚è¿™æ˜¯ä¸€ç§å¸¸è§çš„åšæ³•ï¼Œä»¥ç¡®ä¿åº”ç”¨ç¨‹åºçš„ç¬¦å·ä¿¡æ¯ä¸ä¼šè¢«å¤–éƒ¨ä½¿ç”¨ã€‚

ä½†å®é™…æŸ¥çœ‹ä¸»äºŒè¿›åˆ¶æ–‡ä»¶å¯ä»¥çœ‹åˆ°ä¸»äºŒè¿›åˆ¶è¿˜æ˜¯æš´éœ²äº†ä¸€äº›ç¬¦å·ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬éœ€è¦é€šè¿‡è®¾ç½®`EXPORTED_SYMBOLS_FILE`ä¸ºä¸€ä¸ªç©ºçš„æ–‡ä»¶æ¥è§£å†³ã€‚

> åœ¨è®¾ç½®ä¸º "Symbols Hidden by Default" ä¸º "Yes" åï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·Â `nm`ï¼ˆname listï¼‰æ¥æŸ¥çœ‹ä¸»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ç¬¦å·æ˜¯å¦è¢«é™åˆ¶åœ¨å½“å‰ç¼–è¯‘å•å…ƒå†…éƒ¨å¯è§ã€‚
> 
> è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š
> 
> 1. åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨Â `cd`Â å‘½ä»¤åˆ‡æ¢åˆ°ä¸»äºŒè¿›åˆ¶æ–‡ä»¶çš„ç›®å½•ã€‚ä¾‹å¦‚ï¼š`cd /path/to/YourApp.app`
> 2. ä½¿ç”¨Â `nm`Â å‘½ä»¤æŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶çš„ç¬¦å·åˆ—è¡¨ã€‚ä¾‹å¦‚ï¼š`nm -gU YourApp`
> 
> åœ¨è¾“å‡ºç»“æœä¸­ï¼Œä½ ä¼šçœ‹åˆ°ä¸åŒç±»å‹çš„ç¬¦å·ï¼Œä¾‹å¦‚å‡½æ•°ã€å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ã€‚å¯¹äºè¢«éšè—çš„ç¬¦å·ï¼Œå¯èƒ½ä¼šæ˜¾ç¤ºä¸ºÂ `U`Â æˆ–Â `u`ï¼Œè¿™æ„å‘³ç€å®ƒä»¬æ˜¯æœªå®šä¹‰çš„æˆ–å±€éƒ¨çš„ç¬¦å·ã€‚è¿™äº›ç¬¦å·åœ¨å½“å‰äºŒè¿›åˆ¶æ–‡ä»¶ä»¥å¤–æ˜¯ä¸å¯è§çš„ã€‚
> 
> ç›¸åï¼Œå¦‚æœç¬¦å·æ˜¾ç¤ºä¸ºÂ `T`ï¼ˆå‡½æ•°ï¼‰æˆ–Â `D`ï¼ˆæ•°æ®ï¼‰ï¼Œåˆ™è¡¨ç¤ºå®ƒä»¬æ˜¯å¯è§çš„å…¨å±€å‡½æ•°æˆ–æ•°æ®ã€‚è¿™äº›ç¬¦å·å¯èƒ½æ˜¯ç”±äºè®¾ç½®ä¸º "No" æˆ–å…¶ä»–é…ç½®ï¼Œè€Œå…è®¸åœ¨å¤–éƒ¨æ¨¡å—ä¸­è®¿é—®çš„ç¬¦å·ã€‚
> 
> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™åªèƒ½æä¾›å…³äºç¬¦å·æ˜¯å¦è¢«éšè—çš„ä¿¡æ¯ï¼Œè€Œæ— æ³•æä¾›è¯¦ç»†çš„å‡½æ•°æˆ–å˜é‡åç§°ã€‚å¦‚æœéœ€è¦æŸ¥çœ‹æ›´è¯¦ç»†çš„ç¬¦å·ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸“é—¨çš„åæ±‡ç¼–å·¥å…·ï¼ˆå¦‚ Hopper Disassemblerï¼‰æ¥åˆ†æå’ŒæŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶çš„å†…å®¹ã€‚
> 
> æ€»è€Œè¨€ä¹‹ï¼Œä½¿ç”¨Â `nm`Â å‘½ä»¤å¯ä»¥æŸ¥çœ‹è¢«éšè—çš„ç¬¦å·ï¼Œå¹¶åˆ¤æ–­å…¶æ˜¯å¦è¢«é™åˆ¶åœ¨å½“å‰ç¼–è¯‘å•å…ƒå†…éƒ¨å¯è§ã€‚

5. ##### **Strip Linked Product**

`Strip Linked Product`Â è®¾ç½®ä¸ºYESå¯ä»¥å»é™¤ä¸éœ€è¦çš„ç¬¦å·ä¿¡æ¯Â **ã€‚**Â éœ€è¦æ³¨æ„`Strip Linked Product`Â é€‰é¡¹åœ¨Â `Deployment Postprocessing`Â è®¾ç½®ä¸º YES çš„æ—¶å€™æ‰ç”Ÿæ•ˆï¼Œè€ŒÂ `Deployment Postprocessing`Â åœ¨ Archive æ—¶ä¸å—æ‰‹åŠ¨è®¾ç½®çš„å½±å“ï¼Œä¼šè¢«å¼ºåˆ¶è®¾ç½®æˆ YESã€‚

ç»“è®ºï¼šå°†`Deployment Postprocessing`è®¾ç½®ä¸º NOï¼Œå°†`Strip Linked Product`è®¾ç½®ä¸º`YES`ã€‚

#### å…«ã€æ€»ç»“

é¦–å…ˆï¼Œè¦æœ‰ä¸ªé¢„ç ”çš„é˜¶æ®µï¼Œå¯ä»¥ä»`ipa`æ„æˆçš„å„ä¸ªè§’åº¦å‡ºå‘æ€è€ƒä¼˜åŒ–çš„æ–¹å‘ï¼Œç»“åˆè‡ªå·±çš„æƒ³æ³•ï¼Œå‚è€ƒç½‘ä¸Šçš„ä¸€äº›åšæ³•å¤šå®è·µï¼›å…¶æ¬¡ï¼Œåˆ°çœŸæ­£è¿ç”¨åˆ°çº¿ä¸Šé¡¹ç›®æ—¶ï¼Œæ ¹æ®ä¼˜åŒ–çš„æŒ‡æ ‡ç›®æ ‡ï¼Œç»“åˆROIã€é£é™©ã€ç”¨æˆ·ä½“éªŒç­‰é€‰æ‹©å…¶ä¸­ä¸€äº›åšæ³•ï¼Œè¿™æ ·å¯¹è‡ªå·±çš„APPæ¥è¯´æ‰æ˜¯åˆé€‚çš„ï¼›æœ€åï¼ŒåŒ…ä½“ç§¯ä¼˜åŒ–æ—¶è·Ÿå¯åŠ¨é€Ÿåº¦ã€ç¼–è¯‘é€Ÿåº¦æŒ‡æ ‡ä¹Ÿæ˜¯æœ‰ç›¸å…³æ€§çš„ï¼Œåœ¨å®è·µæ—¶éœ€è¦è€ƒè™‘æ˜¯å¦ä¼šå½±å“å…¶å®ƒæŒ‡æ ‡ã€‚

å‚è€ƒæ–‡ç« ï¼š

1. [åº”ç”¨çš„ APK å¤§å°å¦‚ä½•å½±å“å®‰è£…è½¬åŒ–ç‡](https://link.juejin.cn/?target=https%3A%2F%2Fmedium.com%2Fgoogleplaydev%2Fshrinking-apks-growing-installs-5d3fcba23ce2 "https://medium.com/googleplaydev/shrinking-apks-growing-installs-5d3fcba23ce2")
2. [What is app thinning? (iOS, tvOS, watchOS)](https://link.juejin.cn/?target=https%3A%2F%2Fhelp.apple.com%2Fxcode%2Fmac%2Fcurrent%2F%23%2Fdevbbdc5ce4f "https://help.apple.com/xcode/mac/current/#/devbbdc5ce4f")
3. [è‹¹æœå…³äº__Textæ®µå¤§å°çš„è¦æ±‚](https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.apple.com%2Fhelp%2Fapp-store-connect%2Freference%2Fmaximum-build-file-sizes "https://developer.apple.com/help/app-store-connect/reference/maximum-build-file-sizes")
4. [Reducing your appâ€™s size](https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.apple.com%2Fcn%2Fdocumentation%2Fxcode%2Freducing_your_app_s_size%2F "https://developer.apple.com/cn/documentation/xcode/reducing_your_app_s_size/")
5. [iOSå®‰è£…åŒ…å¤§å°ä¼˜åŒ–ç¬”è®°](https://juejin.cn/post/7260819638123380793 "https://juejin.cn/post/7260819638123380793")
6. [æŠ–éŸ³å“è´¨å»ºè®¾ - iOS å®‰è£…åŒ…å¤§å°ä¼˜åŒ–å®è·µç¯‡](https://link.juejin.cn/?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FLSP8kC09zjb-sDjgZaikbg "https://mp.weixin.qq.com/s/LSP8kC09zjb-sDjgZaikbg")
7. [ç™¾åº¦APP iOSç«¯åŒ…ä½“ç§¯50Mä¼˜åŒ–å®è·µ(äº”) HEICå›¾ç‰‡å’Œæ— ç”¨ç±»ä¼˜åŒ–å®è·µ](https://link.juejin.cn/?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FRFI9vqxa_eTA8OdD3Y7oCw "https://mp.weixin.qq.com/s/RFI9vqxa_eTA8OdD3Y7oCw")
8. [å¦‚ä½•è®©äº‘éŸ³ä¹iOSåŒ…ä½“ç§¯å‡å°‘87MB](https://link.juejin.cn/?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FGTbhvzMA-W0ANlars7mKog "https://mp.weixin.qq.com/s/GTbhvzMA-W0ANlars7mKog")
9. [iOS On-Demand Resources](https://link.juejin.cn/?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2F6676c2f65837 "https://www.jianshu.com/p/6676c2f65837")
10. [iOS é™æ€åº“å’ŒåŠ¨æ€åº“å¯¹ipaåŒ…å¤§å°çš„å½±å“](https://link.juejin.cn/?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2F2dd7fe0c4333 "https://www.jianshu.com/p/2dd7fe0c4333")
11. [é€šè¿‡LinkMapæŸ¥çœ‹å„ä¸ªç±»åº“é“¾æ¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­å çš„ä½“ç§¯](https://link.juejin.cn/?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2Fa500ebce9f34 "https://www.jianshu.com/p/a500ebce9f34")
12. [å…³äºXcodeç¼–è¯‘æ€§èƒ½ä¼˜åŒ–çš„ç ”ç©¶å·¥ä½œæ€»ç»“](https://link.juejin.cn/?target=https%3A%2F%2Fblog.csdn.net%2Fqq_25131687%2Farticle%2Fdetails%2F52194034 "https://blog.csdn.net/qq_25131687/article/details/52194034")
13. [æŸ¥çœ‹ipaä¸­çš„å„éƒ¨åˆ†å¤§å°çš„å·¥å…·](https://link.juejin.cn/?target=http%3A%2F%2Fwww.derlien.com%2F "http://www.derlien.com/")
14. [Macä¸Šæå–assets.carçš„å›¾ç‰‡](https://link.juejin.cn/?target=https%3A%2F%2Fkfft6vo8un.feishu.cn%2Fdocs%2FdoccnMk62asscnnwjwlFzOaIR6e "https://kfft6vo8un.feishu.cn/docs/doccnMk62asscnnwjwlFzOaIR6e")
